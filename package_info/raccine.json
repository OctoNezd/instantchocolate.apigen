{"description": "![Raccine](https://raw.githubusercontent.com/Neo23x0/Raccine/main/images/raccine_logo.png)\n\n# Raccine\n\nA Simple Ransomware Protection \n\n## Why\n\nWe see ransomware delete all shadow copies using `vssadmin` pretty often. What if we could just intercept that request and kill the invoking process? Let's try to create a simple vaccine.\n\n![Ransomware Process Tree](https://raw.githubusercontent.com/Neo23x0/Raccine/main/images/screen4.png)\n\n## How it works\n\nWe [register a debugger](https://attack.mitre.org/techniques/T1546/012/) for `vssadmin.exe` (and `wmic.exe`), which is our compiled `raccine.exe`. Raccine is a binary, that first collects all PIDs of the parent processes and then tries to kill all parent processes. \n\nAvantages:\n\n- The method is rather generic\n- We don't have to replace a system file (`vssadmin.exe` or `wmic.exe`), which could lead to integrity problems and could break our raccination on each patch day \n- Flexible YARA rule scanning of command line params for malicious activity\n- The changes are easy to undo\n- Runs on Windows 7 / Windows 2008 R2 or higher\n- No running executable or additional service required (agent-less)\n\nDisadvantages / Blind Spots:\n\n- The legitimate use of `vssadmin.exe delete shadows` (or any other blacklisted combination) isn't possible anymore\n- It even kills the processes that tried to invoke `vssadmin.exe delete shadows`, which could be a backup process\n- This won't catch methods in which the malicious process isn't one of the processes in the tree that has invoked `vssadmin.exe` (e.g. via `schtasks`)\n\n## Example\n\nEmotet without Raccine - [Link](https://app.any.run/tasks/b12f8ee2-f6cc-4571-bcc2-51e34c19941f/)\n\n![Emotet wihtout Raccine](https://raw.githubusercontent.com/Neo23x0/Raccine/main/images/emotet-wo-raccine.png)\n\nEmotet with Raccine - [Link](https://app.any.run/tasks/057ff7f5-43c1-4e51-93c3-a702c6fb0d75/) (ignore the process activity that is related to the Raccine installation)\n\n![Emotet wihtout Raccine](https://raw.githubusercontent.com/Neo23x0/Raccine/main/images/emotet-with-raccine.png)\n\nThe infection gets nipped in the bud. \n\n## Warning !!!\n\nUSE IT AT YOUR OWN RISK!\n\nYou won't be able to run commands that use the blacklisted commands on a raccinated machine anymore until your apply the uninstall patch `raccine-reg-patch-uninstall.reg`. This could break various backup solutions that run that specific command during their work. It will not only block that request but kills all processes in that tree including the backup solution and its invoking process.\n\nIf you have a solid security monitoring that logs all process executions, you could check your logs to see if `vssadmin.exe delete shadows`, `vssadmin.exe resize shadowstorage ...` or the other blocked command lines are frequently or sporadically used for legitimate purposes in which case you should refrain from using Raccine.\n\n*Please Note* This is an automatically updated package.  If the package is outdated for more than two days, please let me know.", "updated": "2024-03-09T11:18:46Z", "galleryUrl": "https://community.chocolatey.org/packages/raccine/1.4.4", "abuseUrl": "https://community.chocolatey.org/package/ReportAbuse/raccine/1.4.4", "licenseUrl": "https://github.com/Neo23x0/Raccine/blob/main/LICENSE", "packageName": "raccine", "displayName": "Raccine", "summary": "A Simple Ransomware Vaccine", "version": "1.4.4", "icon": "", "author": "Neo23x0", "downloadCount": 404, "tags": ["ransomware", "vaccine", "shadow", "copy", "service", "vssadmin", "protection", "malware", "yara", "security"]}